<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Ragty"><meta name="copyright" content="Ragty"><title>When the world sleep, I dream. | Ragty の Blog</title><link rel="shortcut icon" href="/blog/melody-favicon.ico"><link rel="stylesheet" href="/blog/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><script>var GLOBAL_CONFIG = { 
  root: '/blog/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script><meta name="generator" content="Hexo 4.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="https://secure.gravatar.com/avatar/dcc38a5a0d37cb7348d4f72d8f6a2de0"></div><div class="author-info__name text-center">Ragty</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/huoji555" target="_blank" rel="noopener">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/blog/archives"><span class="pull-left">文章</span><span class="pull-right">83</span></a><a class="author-info-articles__tags article-meta" href="/blog/tags"><span class="pull-left">标签</span><span class="pull-right">75</span></a><a class="author-info-articles__categories article-meta" href="/blog/categories"><span class="pull-left">分类</span><span class="pull-right">38</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接-Links</div><a class="author-info-links__name text-center" href="https://blog.csdn.net/huoji555" target="_blank" rel="noopener">MY-CSDN</a></div></div></div><nav id="nav" style="background-image: url(https://blog-1251750343.cos.ap-beijing.myqcloud.com/blog/blog-bg.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/blog/">Ragty の Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/blog">Home</a><a class="site-page" href="/blog/archives">Archives</a><a class="site-page" href="/blog/categories">Categories</a><a class="site-page" href="/blog/tags">Tags</a><a class="site-page" href="/blog/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="site-info"><div id="site-title">Ragty の Blog</div><div id="site-sub-title">When the world sleep, I dream.</div><div id="site-social-icons"><a class="social-icon" href="https://github.com/huoji555" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-github fab"></i></a><a class="social-icon" href="https://blog.csdn.net/huoji555" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-rss fas"></i></a></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/04/12/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89%E5%8F%8C%E9%93%BE%E8%A1%A8/">数据结构思维笔记（六）双链表</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-12</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4/">数据结构思维</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4-%E5%8F%8C%E9%93%BE%E8%A1%A8/">数据结构思维 双链表</a></span><div class="content"><a id="more"></a>

<h6 id="1-双链表数据结构"><a href="#1-双链表数据结构" class="headerlink" title="1.双链表数据结构"></a>1.双链表数据结构</h6><blockquote>
<p><code>List</code>和<code>Deque</code>接口的双链表实现。[…] 所有的操作都能像双向列表那样执行。索引该列表中的操作将从头或者尾遍历列表，使用更接近指定索引的那个。</p>
</blockquote>
<ul>
<li>每个节点包含下一个节点的链接和上一个节点的链接。</li>
<li><code>LinkedList</code>对象包含指向列表的第一个和最后一个元素的链接。</li>
</ul>
<p>所以我们<strong>可以从列表的任意一端开始，并以任意方向遍历它</strong>。因此，我们可以在常数时间内，在列表的头部和末尾添加和删除元素！<br><br></p>
<h6 id="2-ArrayList-LinkedList和双链表的对比"><a href="#2-ArrayList-LinkedList和双链表的对比" class="headerlink" title="2.ArrayList,LinkedList和双链表的对比"></a>2.ArrayList,LinkedList和双链表的对比</h6><table>
<thead>
<tr>
<th></th>
<th align="center"><strong>MyArrayList</strong></th>
<th align="center"><strong>MyLinkedList</strong></th>
<th align="center">双链表</th>
</tr>
</thead>
<tbody><tr>
<td><code>add</code>（末尾）</td>
<td align="center">1</td>
<td align="center">n</td>
<td align="center">1</td>
</tr>
<tr>
<td><code>add</code>（开头）</td>
<td align="center">n(剩余的都往后)</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td><code>add</code>（一般）</td>
<td align="center">n</td>
<td align="center">n</td>
<td align="center">n</td>
</tr>
<tr>
<td><code>get</code> / <code>set</code></td>
<td align="center">1</td>
<td align="center">n</td>
<td align="center">n</td>
</tr>
<tr>
<td><code>indexOf</code> / <code>lastIndexOf</code></td>
<td align="center">n</td>
<td align="center">n</td>
<td align="center">n</td>
</tr>
<tr>
<td><code>isEmpty</code> / <code>size</code></td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td><code>remove</code>（末尾）</td>
<td align="center">1</td>
<td align="center">n</td>
<td align="center">1</td>
</tr>
<tr>
<td><code>remove</code>（开头）</td>
<td align="center">n</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td><code>remove</code>（一般）</td>
<td align="center">n</td>
<td align="center">n</td>
<td align="center">n</td>
</tr>
</tbody></table>
<br>



<h6 id="3-结构的选择"><a href="#3-结构的选择" class="headerlink" title="3.结构的选择"></a>3.结构的选择</h6><p>对于头部插入和删除，双链表的实现优于<code>ArrayList</code>。对于尾部插入和删除，都是一样好。所以，<code>ArrayList</code>唯一优势是<code>get</code>和<code>set</code>，链表中它需要线性时间，即使是双链表(<strong>根据实际需要解决的问题来看</strong>)。</p>
<p>如果你知道，你的应用程序的运行时间取决于<code>get</code>和<code>set</code>元素的所需时间，则<code>ArrayList</code>可能是更好的选择。如果运行时间取决于在开头或者末尾附加添加和删除元素，<code>LinkedList</code>可能会更好。</p>
<p>但请记住，这些建议是基于大型问题的增长级别。还有其他因素要考虑：</p>
<ul>
<li>如果这些操作不占用你应用的大部分运行时间 - 也就是说，如果你的应用程序花费大部分时间来执行其他操作 - 那么你对<code>List</code>实现的选择并不重要。</li>
<li>如果你正在处理的列表不是很大，你可能无法获得期望的性能。对于小型问题，二次算法可能比线性算法更快，或者线性可能比常数时间更快。而对于小型问题，差异可能并不重要。</li>
<li>另外，别忘了空间。到目前为止，我们专注于运行时间，但不同的实现需要不同的空间。在<code>ArrayList</code>中，这些元素并排存储在单个内存块中，所以浪费的空间很少，并且计算机硬件通常在连续的块上更快。在链表中，每个元素需要一个节点，带有一个或两个链接。链接占用空间（有时甚至超过数据！），并且节点分散在内存中，硬件效率可能不高。</li>
</ul>
<p>总而言之，算法分析为数据结构的选择提供了一些指南，但只有：</p>
<ul>
<li>你的应用的运行时间很重要，</li>
<li>你的应用的运行时间取决于你选择的数据结构，以及，</li>
<li>问题的规模足够大，增长级别实际上预测了哪个数据结构更好。</li>
</ul>
<p>作为一名软件工程师，在较长的职业生涯中，你几乎不必考虑这种情况。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/04/11/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/">数据结构思维笔记（五）性能分析</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4/">数据结构思维</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4-%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/">数据结构思维 性能分析</a></span><div class="content"><a id="more"></a>

<p>对于下一个练习，我提供了一个<code>Profiler</code>类，它包含代码，使用一系列<strong>问题规模运行方法</strong>，<strong>测量运行时间</strong>和<strong>绘制结果</strong>。</p>
<blockquote>
<p>你将使用<code>Profiler</code>，为 Java 的实现<code>ArrayList</code>和<code>LinkedList</code>，划分<code>add</code>方法的性能。</p>
</blockquote>
<ul>
<li><code>Profiler.java</code>包含上述<code>Profiler</code>类的实现。你会使用这个类，但你不必知道它如何工作。但可以随时阅读源码。</li>
<li><code>ProfileListAdd.java</code>包含此练习的起始代码，包括上面的示例，它测量了<code>ArrayList.add</code>。你将修改此文件来测量其他一些方法。<br><br></li>
</ul>
<h6 id="2-ArrayList的尾部添加"><a href="#2-ArrayList的尾部添加" class="headerlink" title="2.ArrayList的尾部添加"></a>2.ArrayList的尾部添加</h6><p>示例，展示如何使用分析器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">profileArrayListAddEnd</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Profiler.Timeable timeable = <span class="keyword">new</span> Profiler.Timeable() &#123;</span><br><span class="line">            List&lt;String&gt; list;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">                list = <span class="keyword">new</span> ArrayList&lt;String&gt;();<span class="comment">//执行在启动计时之前所需的任何工作</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">timeMe</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;  <span class="comment">//执行我们试图测量的任何操作</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">                    list.add(<span class="string">"anything"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        Profiler profiler = <span class="keyword">new</span> Profiler(<span class="string">"ArrayListAddEnd"</span>,timeable);</span><br><span class="line">        <span class="keyword">int</span> startN = <span class="number">4000</span>;</span><br><span class="line">        <span class="keyword">int</span> endMils = <span class="number">1000</span>;</span><br><span class="line">        <span class="comment">//绘制图像(好像MATLAB)</span></span><br><span class="line">        XYSeries series = profiler.timingLoop(startN,endMils);</span><br><span class="line">        profiler.plotResults(series);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>此方法测量在<code>ArrayList</code>上运行<code>add</code>所需的时间，它向末尾添加新元素</strong>。</p>
<blockquote>
<p>为了使用<code>Profiler</code>，我们需要创建一个<code>Timeable</code>，它提供两个方法：<code>setup</code>和<code>timeMe</code>。</p>
</blockquote>
<ul>
<li><code>setup</code>方法执行在<strong>启动计时之前所需的任何工作</strong>；这里它会创建一个空列表。</li>
<li>然后<code>timeMe</code><strong>执行我们试图测量的任何操作</strong>；这里它将<code>n</code>个元素添加到列表中。</li>
</ul>
<blockquote>
<p><code>Profiler</code>提供了<code>timingLoop</code>，它使用存储为实例变量的<code>Timeable</code>。它多次调用<code>Timeable</code>对象上的<code>timeMe</code>方法，使用一系列的<code>n</code>值。<code>timingLoop</code>接受两个参数：</p>
</blockquote>
<ul>
<li><code>startN</code>是<code>n</code>的值，计时循环应该从它开始。</li>
<li><code>endMillis</code>是以毫秒为单位的阈值。随着 <code>timingLoop</code>增加问题规模，运行时间增加；当运行时间超过此阈值时，<code>timingLoop</code>停止。</li>
</ul>
<p><strong>当你运行实验时，你可能需要调整这些参数。如果<code>startN</code>太低，运行时间可能太短，无法准确测量。如果<code>endMillis</code>太低，你可能无法获得足够的数据，来查看问题规模和运行时间之间的明确关系。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4000</span>, <span class="number">3</span></span><br><span class="line"><span class="number">8000</span>, <span class="number">0</span></span><br><span class="line"><span class="number">16000</span>, <span class="number">1</span></span><br><span class="line"><span class="number">32000</span>, <span class="number">2</span></span><br><span class="line"><span class="number">64000</span>, <span class="number">3</span></span><br><span class="line"><span class="number">128000</span>, <span class="number">6</span></span><br><span class="line"><span class="number">256000</span>, <span class="number">18</span></span><br><span class="line"><span class="number">512000</span>, <span class="number">30</span></span><br><span class="line"><span class="number">1024000</span>, <span class="number">88</span></span><br><span class="line"><span class="number">2048000</span>, <span class="number">185</span></span><br><span class="line"><span class="number">4096000</span>, <span class="number">242</span></span><br><span class="line"><span class="number">8192000</span>, <span class="number">544</span></span><br><span class="line"><span class="number">16384000</span>, <span class="number">1325</span> （超过预定时间）</span><br></pre></td></tr></table></figure>
<p><strong>第一列是问题规模，<code>n</code>；第二列是以毫秒为单位的运行时间</strong>。前几个测量非常嘈杂；最好将<code>startN</code>设置在<code>64000</code>左右。（每次得出的结果不同，可具体分析，最后得出一张图，如图所示）</p>
<p><img src="https://wizardforcel.gitbooks.io/think-dast/content/img/4-1.jpg" alt=""><br><strong>结果分析：</strong></p>
<blockquote>
<p>基于我们对<code>ArrayList</code>工作方式的理解，我们期望，在添加元素到最后时，<code>add</code>方法需要常数时间。所以添加<code>n</code>个元素的<strong>总时间应该是线性</strong>的。</p>
<p>为了测试这个理论，我们可以绘制总运行时间和问题规模，我们应该看到一条直线，至少对于大到足以准确测量的问题规模。在数学上，我们可以为这条直线编写一个函数：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runtime = a + b * n</span><br></pre></td></tr></table></figure>

<p>其中<code>a</code>是线的截距，<code>b</code>是斜率。</p>
<p>另一方面，如果<code>add</code>是线性的，则<code>n</code>次添加的总时间将是平方。如果我们绘制运行时间与问题规模，我们预计会看到抛物线。或者在数学上，像：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runtime = a + b * n + c * n^<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>对于<code>n</code>的较大值，<strong>最大指数项是最重要的</strong>，因此：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runtime ≈ c * n^k</span><br></pre></td></tr></table></figure>

<p>其中<code>≈</code>意思是“大致相等”。现在，如果我们对这个方程的两边取对数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log(runtime) ≈ log(c) + k * log(n)</span><br></pre></td></tr></table></figure>

<p>这个方程式意味着，如果我们在重对数合度上绘制运行时间与<code>n</code>，我们预计看到一条直线，截距为<code>log(c)</code>，斜率为<code>k</code>。我们<strong>不太在意截距，但斜率表示增长级别</strong>：如果<code>k = 1</code>，算法是线性的；如果<code>k = 2</code>，则为平方的。</p>
<p>看上一节中的数字，你可以<strong>通过眼睛来估计斜率</strong>。但是当你调用<code>plotResults</code>它时，会计算数据的最小二乘拟合并打印估计的斜率。在这个例子中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Estimated slope &#x3D; 1.06194352346708(这个值是不一定的)</span><br></pre></td></tr></table></figure>

<p>它接近<code>1</code>；并且这表明<code>n</code>次添加的总时间是线性的，所以每个添加是常数时间，像预期的那样。</p>
<p>其中重要的一点：如果你在图形看到这样的直线，这并不意味着该算法是线性的。如果对于任何指数<code>k</code>，运行时间与<code>n ** k</code>成正比，我们预计看到斜率为<code>k</code>的直线。<strong>如果斜率接近<code>1</code>，则表明算法是线性的。如果接近<code>2</code>，它可能是平方的。</strong><br><br></p>
<h6 id="3-ArrayList的首部添加"><a href="#3-ArrayList的首部添加" class="headerlink" title="3.ArrayList的首部添加"></a>3.ArrayList的首部添加</h6><p><strong>预估：</strong></p>
<p>我们每次在ArrayList的首部进行添加，需要移动n个元素，执行n次，所以我们预估时间复杂度为O(n^2).斜率接近于2.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">profileArrayListAddBeginning</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Profiler.Timeable timeable = <span class="keyword">new</span> Profiler.Timeable() &#123;</span><br><span class="line">        List&lt;String&gt; list;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">            list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">timeMe</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">                list.add(<span class="number">0</span>,<span class="string">"anything"</span>);  <span class="comment">//使用双参方法，不断把最新的元素放到ArrayList首位</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> startN = <span class="number">4000</span>;</span><br><span class="line">    <span class="keyword">int</span> endMillis = <span class="number">10000</span>;</span><br><span class="line">    runProfiler(<span class="string">"ArrayList add beginning"</span>, timeable, startN, endMillis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个方法几乎和<code>profileArrayListAddEnd</code>相同。<strong>唯一的区别在于<code>timeMe</code>，它使用<code>add</code>的双参数版本，将新元素置于下标<code>0</code>处</strong>。同样，我们增加了<code>endMillis</code>，来获取一个额外的数据点。</p>
<p>以下是时间结果（左侧是问题规模，右侧是运行时间，单位为毫秒）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4000</span>, <span class="number">14</span></span><br><span class="line"><span class="number">8000</span>, <span class="number">35</span></span><br><span class="line"><span class="number">16000</span>, <span class="number">150</span></span><br><span class="line"><span class="number">32000</span>, <span class="number">604</span></span><br><span class="line"><span class="number">64000</span>, <span class="number">2518</span></span><br><span class="line"><span class="number">128000</span>, <span class="number">11555</span></span><br></pre></td></tr></table></figure>

<p><strong>以下是运行时间和问题规模曲线:</strong></p>
<p><img src="https://wizardforcel.gitbooks.io/think-dast/content/img/5-1.jpg" alt=""></p>
<p><strong>分析结果：</strong></p>
<p>请记住，<strong>该图上的直线并不意味着该算法是线性的</strong>。相反，如果对于任何指数<code>k</code>，运行时间与<code>n ^ k</code>成正比，我们预计会看到斜率为<code>k</code>的直线。在这种情况下，我们预计，<code>n</code>次添加的总时间与<code>n ^ 2</code>成正比，所以我们预计会有一条斜率为<code>2</code>的直线。实际上，估计的斜率是<code>1.992</code>，非常接近。恐怕假数据才能做得这么好。(<strong>还是看斜率，与预期相符合</strong>)<br><br></p>
<h6 id="4-LInkedList的首部添加"><a href="#4-LInkedList的首部添加" class="headerlink" title="4.LInkedList的首部添加"></a>4.LInkedList的首部添加</h6><p><strong>预估：</strong></p>
<p>LinkedList首部添加不需要移动元素，操作时间复杂度为O(1),操作n次，预估时间复杂度为O(n^2)，预估他是线性的.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">profileLinkedListAddBegining</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Profiler.Timeable timeable = <span class="keyword">new</span> Profiler.Timeable() &#123;</span><br><span class="line">        List&lt;String&gt; list;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">            list = <span class="keyword">new</span> LinkedList&lt;String&gt;(); <span class="comment">//这边初始化为LinkedList</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">timeMe</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">                list.add(<span class="number">0</span>,<span class="string">"lalalalala"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> startN = <span class="number">128000</span>;  <span class="comment">//这些数值是慢慢测试出来的</span></span><br><span class="line">    <span class="keyword">int</span> endMils = <span class="number">2000</span>;</span><br><span class="line">    runProfiler(<span class="string">"LinkedList add beginning"</span>,timeable,startN,endMils);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试结果（有一点嘈杂这个结果）：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">128000</span>, <span class="number">16</span></span><br><span class="line"><span class="number">256000</span>, <span class="number">19</span></span><br><span class="line"><span class="number">512000</span>, <span class="number">28</span></span><br><span class="line"><span class="number">1024000</span>, <span class="number">77</span></span><br><span class="line"><span class="number">2048000</span>, <span class="number">330</span></span><br><span class="line"><span class="number">4096000</span>, <span class="number">892</span></span><br><span class="line"><span class="number">8192000</span>, <span class="number">1047</span></span><br><span class="line"><span class="number">16384000</span>, <span class="number">4755</span></span><br></pre></td></tr></table></figure>

<p><strong>以下是运行时间和问题规模曲线:</strong></p>
<p><img src="https://wizardforcel.gitbooks.io/think-dast/content/img/5-2.jpg" alt=""></p>
<p><strong>结果分析：</strong></p>
<p>并不是一条很直的线，斜率也不是正好是<code>1</code>，最小二乘拟合的斜率是<code>1.23</code>。但是结果表示，<code>n</code>次添加的总时间至少近似于<code>O(n)</code>，所以<strong>每次添加都是常数时间</strong>。<br></p>
<h6 id="5-LinkedList的尾部添加"><a href="#5-LinkedList的尾部添加" class="headerlink" title="5.LinkedList的尾部添加"></a>5.LinkedList的尾部添加</h6><p><strong>预估：</strong></p>
<p>LinkedList的尾部添加，需要逐个便利，操作是线性的，为O(n)，操作n次,时间复杂度为O(n^2).</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">profileLinkedListAddEnd</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Profiler.Timeable timeable = <span class="keyword">new</span> Profiler.Timeable() &#123;</span><br><span class="line">        List&lt;String&gt; list;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">            list = <span class="keyword">new</span> LinkedList&lt;String&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">timeMe</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line">                list.add(<span class="string">"CN DOTA BEST DOTA"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> startN = <span class="number">64000</span>;</span><br><span class="line">    <span class="keyword">int</span> endMils = <span class="number">1000</span>;</span><br><span class="line">    runProfiler(<span class="string">"LinkedListAddEnd"</span>,timeable,startN,endMils);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试结果：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">64000</span>, <span class="number">9</span></span><br><span class="line"><span class="number">128000</span>, <span class="number">9</span></span><br><span class="line"><span class="number">256000</span>, <span class="number">21</span></span><br><span class="line"><span class="number">512000</span>, <span class="number">24</span></span><br><span class="line"><span class="number">1024000</span>, <span class="number">78</span></span><br><span class="line"><span class="number">2048000</span>, <span class="number">235</span></span><br><span class="line"><span class="number">4096000</span>, <span class="number">851</span></span><br><span class="line"><span class="number">8192000</span>, <span class="number">950</span></span><br><span class="line"><span class="number">16384000</span>, <span class="number">6160</span></span><br></pre></td></tr></table></figure>

<p><strong>以下是运行时间和问题规模曲线：</strong></p>
<p><img src="https://wizardforcel.gitbooks.io/think-dast/content/img/5-3.jpg" alt=""></p>
<p><strong>结果分析：</strong></p>
<p>同样，测量值很嘈杂，线不完全是直的，但估计的斜率为<code>1.19</code>，接近于在头部添加元素，而并不非常接近<code>2</code>，这是我们根据分析的预期。事实上，它接近<code>1</code>，这表明在尾部添加元素是常数元素。(思考一个问题，它的问题规模为什么这么大，大概有0.2的偏差，经验证，问题规模在400w的时候会有一个明显的下降)<br><br><br></p>
<p>原书链接：<a href="https://wizardforcel.gitbooks.io/think-dast/content/5.html" target="_blank" rel="noopener">https://wizardforcel.gitbooks.io/think-dast/content/5.html</a><br>GitHub链接(提供源码)：<a href="https://github.com/huoji555/Shadow/tree/master/DataStructure" target="_blank" rel="noopener">https://github.com/huoji555/Shadow/tree/master/DataStructure</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/04/11/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89LinkedList/">数据结构思维笔记（四）LinkedList</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4/">数据结构思维</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4-LinkedList/">数据结构思维 LinkedList</a></span><div class="content"><a id="more"></a>

<h6 id="1-链式数据结构"><a href="#1-链式数据结构" class="headerlink" title="1.链式数据结构"></a>1.链式数据结构</h6><blockquote>
<p>在链表中，每个节点包含列表中下一个节点的引用. 其它的链表结构包括树和图，其中节点可以包含多个其它节点的引用。</p>
</blockquote>
<br>

<p>简单的节点Demo</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object node;</span><br><span class="line">    <span class="keyword">public</span> ListNode next;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//init Node</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListNode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.node = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//usually use as the head</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListNode</span><span class="params">(Object node)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.node = node;</span><br><span class="line">        <span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//normal node</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListNode</span><span class="params">(Object node, ListNode next)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.node = node;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ListNode&#123;"</span> + <span class="string">"node="</span> + node + <span class="string">", next="</span> + next + <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>ListNode</code>提供了几个构造函数，可以让你为<code>data</code>和<code>next</code>提供值，或将它们初始化为默认值，<code>null</code>.</p>
</blockquote>
<br>

<p>创造一个链表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ListNode node1 = <span class="keyword">new</span> ListNode(<span class="number">1</span>);</span><br><span class="line">ListNode node2 = <span class="keyword">new</span> ListNode(<span class="number">2</span>);</span><br><span class="line">ListNode node3 = <span class="keyword">new</span> ListNode(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">node1.next = node2;</span><br><span class="line">node2.next = node3;</span><br><span class="line">node3.next = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">ListNode node0 = <span class="keyword">new</span> ListNode(<span class="number">0</span>,node1);</span><br></pre></td></tr></table></figure>

<p><img src="https://wizardforcel.gitbooks.io/think-dast/content/img/3-1.jpg" alt=""></p>
<br>

<h6 id="2-LinkedList初始化结构"><a href="#2-LinkedList初始化结构" class="headerlink" title="2.LinkedList初始化结构"></a>2.LinkedList初始化结构</h6><p>构造内嵌函数Node</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//内嵌函数（Nested Function set the Node）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> E data;</span><br><span class="line">        <span class="keyword">public</span> Node next;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.data = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(E data)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.data = data;</span><br><span class="line">            <span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(E data, Node next)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.data = data;</span><br><span class="line">            <span class="keyword">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<br>

<p>初始化结构</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLinkedList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;            <span class="comment">// keeps track of the number of elements</span></span><br><span class="line">    <span class="keyword">private</span> Node head;           <span class="comment">// reference to the first node</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyLinkedList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        head = <span class="keyword">null</span>;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>存储元素数量不是必需的，并且一般来说，保留冗余信息是有风险的，因为如果没有正确更新，就有机会产生错误。它还需要一点点额外的空间。</p>
</blockquote>
<blockquote>
<p>但是如果我们显式存储<code>size</code>，我们可以实现常数时间的<code>size</code>方法；否则，我们必须遍历列表并对元素进行计数，这需要线性时间。</p>
</blockquote>
<blockquote>
<p>因为我们显式存储<code>size</code>明确地存储，每次添加或删除一个元素时，我们都要更新它，这样一来，这些方法就会减慢，但是它不会改变它们的增长级别，所以很值得。</p>
</blockquote>
<br>

<h6 id="3-LinkedList方法划分"><a href="#3-LinkedList方法划分" class="headerlink" title="3.LinkedList方法划分"></a>3.LinkedList方法划分</h6><p>Add方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">( E element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span>) &#123;</span><br><span class="line">        head = <span class="keyword">new</span> Node(element);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Node node = head;</span><br><span class="line">        <span class="keyword">for</span> (; node.next != <span class="keyword">null</span>; node = node.next) &#123;&#125;      <span class="comment">//loop until the next one</span></span><br><span class="line">        node.next = <span class="keyword">new</span> Node(element);</span><br><span class="line">    &#125;</span><br><span class="line">    size++;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>indexOf方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">       Node node = head;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;size; i++) &#123;</span><br><span class="line">           <span class="keyword">if</span> ( equals(target,node.data) ) &#123;</span><br><span class="line">               <span class="keyword">return</span> i;</span><br><span class="line">           &#125;</span><br><span class="line">           node = node.next;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>那么这种方法的增长级别是什么？</p>
<ul>
<li>每次在循环中，我们调用了<code>equals</code>，这是一个常数时间（它可能取决于<code>target</code>或<code>data</code>大小，但不取决于列表的大小）。循环中的其他操作也是常数时间。</li>
<li>循环可能运行<code>n</code>次，因为在更糟的情况下，我们可能必须遍历整个列表。</li>
</ul>
<p>所以这个方法的运行时间与列表的长度成正比(换言之，是线性的)。</p>
</blockquote>
<br>

<p>Add双参方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (head == <span class="keyword">null</span>) &#123;</span><br><span class="line">           Node node = <span class="keyword">new</span> Node(element);</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           Node node = getNode(index-<span class="number">1</span>);</span><br><span class="line">           node.next = <span class="keyword">new</span> Node(element,node.next);</span><br><span class="line">       &#125;</span><br><span class="line">       size++;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>辅助方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (index&lt;<span class="number">0</span> || index&gt;=size) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException();</span><br><span class="line">       &#125;</span><br><span class="line">       Node node = head;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;index; i++) &#123;</span><br><span class="line">           node = node.next;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> node;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><code>getNode</code>类似<code>indexOf</code>，出于同样的原因也是线性的。</li>
<li>在<code>add</code>中，<code>getNode</code>前后的一切都是常数时间。</li>
</ul>
<p>所以放在一起，<code>add</code>是线性的。</p>
</blockquote>
<br>

<p>Remove方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">       E element = get(index);</span><br><span class="line">       <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">           head = head.next;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           Node node = getNode(index-<span class="number">1</span>);</span><br><span class="line">           node.next = node.next.next;</span><br><span class="line">       &#125;</span><br><span class="line">       size--;</span><br><span class="line">       <span class="keyword">return</span> element;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>remove</code>使用了<code>get</code>查找和存储<code>index</code>处的元素。然后它删除包含它的<code>Node</code>。</p>
<p>如果<code>index==0</code>，我们再次处理这个特殊情况。否则我们找到节点<code>index-1</code>(这个真的是心机，得防止它漏过)并进行修改，来跳过<code>node.next</code>并直接链接到<code>node.next.next</code>。这有效地从列表中删除<code>node.next</code>，它可以被垃圾回收。</p>
<p>当人们看到两个线性操作时，他们有时会认为结果是平方的，但是只有一个操作嵌套在另一个操作中才适用。如果你在一个操作之后调用另一个，运行时间会相加。如果它们都是<code>O(n)</code>的，则总和也是<code>O(n)</code>的。</p>
<p>所以Remove()是线性的</p>
</blockquote>
<br>



<h6 id="4-ArrayList和LinkedList的对比"><a href="#4-ArrayList和LinkedList的对比" class="headerlink" title="4.ArrayList和LinkedList的对比"></a>4.ArrayList和LinkedList的对比</h6><table>
<thead>
<tr>
<th></th>
<th align="center"><strong>MyArrayList</strong></th>
<th align="center"><strong>MyLinkedList</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>add</code>（末尾）</td>
<td align="center">1</td>
<td align="center">n</td>
</tr>
<tr>
<td><code>add</code>（开头）</td>
<td align="center">n(剩余的都往后)</td>
<td align="center">1</td>
</tr>
<tr>
<td><code>add</code>（一般）</td>
<td align="center">n</td>
<td align="center">n</td>
</tr>
<tr>
<td><code>get</code> / <code>set</code></td>
<td align="center">1</td>
<td align="center">n</td>
</tr>
<tr>
<td><code>indexOf</code> / <code>lastIndexOf</code></td>
<td align="center">n</td>
<td align="center">n</td>
</tr>
<tr>
<td><code>isEmpty</code> / <code>size</code></td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td><code>remove</code>（末尾）</td>
<td align="center">1</td>
<td align="center">n</td>
</tr>
<tr>
<td><code>remove</code>（开头）</td>
<td align="center">n</td>
<td align="center">1</td>
</tr>
<tr>
<td><code>remove</code>（一般）</td>
<td align="center">n</td>
<td align="center">n</td>
</tr>
</tbody></table>
<ul>
<li><code>MyArrayList</code>的优势操作是，<strong>插入末尾，移除末尾，获取和设置</strong>。</li>
<li><code>MyLinkedList</code>的优势操作是，插入开头，以及移动开头。（<strong>链式结构头容易获取</strong>）<br>要用哪种看具体的需求<br><br><br></li>
</ul>
<p>原书链接：<a href="https://wizardforcel.gitbooks.io/think-dast/content/5.html" target="_blank" rel="noopener">https://wizardforcel.gitbooks.io/think-dast/content/5.html</a><br>GitHub链接(提供源码)：<a href="https://github.com/huoji555/Shadow/tree/master/DataStructure" target="_blank" rel="noopener">https://github.com/huoji555/Shadow/tree/master/DataStructure</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/04/11/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89ArrayList/">数据结构思维笔记（三）ArrayList</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4/">数据结构思维</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4-ArrayList/">数据结构思维 ArrayList</a></span><div class="content"><a id="more"></a>

<h6 id="1-Add方法"><a href="#1-Add方法" class="headerlink" title="1.Add方法"></a>1.Add方法</h6><p>单参方法(分析它的时间复杂度)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    public boolean add(T element) &#123;</span><br><span class="line">        <span class="comment">//make a bigger array and copy over the elements</span></span><br><span class="line">        <span class="keyword">if</span> (size &gt;= array.length) &#123;</span><br><span class="line">            T[] bigger = <span class="keyword">new</span> <span class="built_in">Object</span>[array.length * <span class="number">2</span>];</span><br><span class="line">            System.arraycopy(array,<span class="number">0</span>,bigger,<span class="number">0</span>,array.length);</span><br><span class="line">            array = bigger;</span><br><span class="line">        &#125;</span><br><span class="line">        array[size] = element;</span><br><span class="line">        size++;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>单参数版本很难分析。如果数组中存在<strong>未使用的空间，那么它是常数时间</strong>，但如果我们必须<strong>调整数组的大小，它是线性的</strong>，因为<code>System.arraycopy</code>所需的时间与数组的大小成正比.（既存在常数时间，又是线性的）</p>
</blockquote>
<blockquote>
<p>那么<code>add</code>是常数还是线性时间的？（先给结论，可以看作是常数的）</p>
</blockquote>
<ul>
<li>我们第一次调用<code>add</code>时，它会在数组中找到未使用的空间，所以它存储<code>1</code>个元素。</li>
<li>第二次，它在数组中找到未使用的空间，所以它存储<code>1</code>个元素。</li>
<li>第三次，我们必须调整数组的大小，复制<code>2</code>个元素，并存储<code>1</code>个元素。现在数组的大小是<code>4</code>。</li>
<li>第四次存储<code>1</code>个元素。</li>
<li>第五次调整数组的大小，复制<code>4</code>个元素，并存储<code>1</code>个元素。现在数组的大小是<code>8</code>。</li>
<li>接下来的<code>3</code>个添加储存<code>3</code>个元素。</li>
<li>下一个添加复制<code>8</code>个并存储<code>1</code>个。现在的大小是<code>16</code>。</li>
<li>接下来的<code>7</code>个添加复制了<code>7</code>个元素。</li>
</ul>
<blockquote>
<p>整理一下规律</p>
</blockquote>
<ul>
<li><code>4</code>次添加之后，我们储存了<code>4</code>个元素，并复制了两个。</li>
<li><code>8</code>次添加之后，我们储存了<code>8</code>个元素，并复制了<code>6</code>个。</li>
<li><code>16</code>次添加之后，我们储存了<code>16</code>个元素，并复制了<code>14</code>个。</li>
</ul>
<blockquote>
<p>现在你应该看到了规律：要执行<code>n</code>次添加，我们必须存储<code>n</code>个元素并复制<code>n-2</code>个。所以操作总数为<code>n + n - 2</code>，为<code>2 * n - 2</code></p>
<p>为了得到每个添加的平均操作次数，我们将总和除以<code>n</code>；结果是<code>2 - 2 / n</code>。随着<code>n</code>变大，第二项<code>2 / n</code>变小。参考我们只关心<code>n</code>的最大指数的原则，我们可以认为<code>add</code>是常数时间的</p>
</blockquote>
<blockquote>
<p>有时线性的算法平均可能是常数时间，这似乎是奇怪的。关键是我们每次调整大小时都加倍了数组的长度。这限制了每个元素被复制的次数。否则 - 如果我们向数组的长度添加一个固定的数量，而不是乘以一个固定的数量 - 分析就不起作用。</p>
</blockquote>
<blockquote>
<p>这种划分算法的方式，通过计算一系列调用中的平均时间，称为摊销分析。你可以在 <a href="http://thinkdast.com/amort" target="_blank" rel="noopener">http://thinkdast.com/amort</a> 上阅读更多信息。重要的想法是，<strong>复制数组的额外成本是通过一系列调用展开或“摊销”的。</strong><br></p>
</blockquote>
<br>

<p>双参方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line"> public <span class="keyword">void</span> add(int index, T element) &#123;</span><br><span class="line">     <span class="keyword">if</span> (index&lt;<span class="number">0</span> || index&gt;size) &#123;</span><br><span class="line">         <span class="keyword">throw</span> IndexOutOfBoundsException;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//new element（扩容之需）</span></span><br><span class="line">     add(element);</span><br><span class="line"></span><br><span class="line">     <span class="comment">//shift the other element</span></span><br><span class="line">     <span class="keyword">for</span> (int i=size<span class="number">-1</span>; i&gt;index; i--) &#123;</span><br><span class="line">         array[i] = array[i<span class="number">-1</span>];</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//put the new one in the right place</span></span><br><span class="line">     array[index] = element;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这个双参数的版本，叫做<code>add(int, E)</code>，它使用了单参数的版本，称为<code>add(E)</code>，它将新的元素放在最后。然后它将其他元素向右移动，并将新元素放在正确的位置</p>
</blockquote>
<blockquote>
<p>现在，如果<code>add(E)</code>是常数时间，那么<code>add(int, E)</code>呢？调用<code>add(E)</code>后，它遍历数组的一部分并移动元素。这个循环是线性的，除了在列表末尾添加的特殊情况中。<strong>因此， <code>add(int, E)</code>是线性的</strong>。<br></p>
</blockquote>
<h6 id="2-划分MyArrayList的方法"><a href="#2-划分MyArrayList的方法" class="headerlink" title="2.划分MyArrayList的方法"></a>2.划分MyArrayList的方法</h6><blockquote>
<p>对于许多方法，我们不能通过测试代码来确定增长级别<br></p>
</blockquote>
<p><strong>常数级别</strong></p>
<blockquote>
<p><code>get</code>中的每个东西都是常数时间的。所以<code>get</code>是常数时间</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> array[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>set</code>中的一切，包括<code>get</code>的调用都是常数时间，所以<code>set</code>也是常数时间</p>
<p>set它不会显式检查数组的边界；它利用<code>get</code>，如果索引无效则引发异常</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    E old = get(index);</span><br><span class="line">    array[index] = element;</span><br><span class="line">    <span class="keyword">return</span> old;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p><strong>线性级别</strong></p>
<blockquote>
<p>每次在循环中，<code>indexOf</code>调用<code>equals</code>，所以我们首先要划分<code>equals</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;size; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (equals(target, array[i])) &#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>equals方法</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object target, Object element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (target == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> element == <span class="keyword">null</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> target.equals(element);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果我们幸运，我们可能会立即找到目标对象，并在测试一个元素后返回。如果我们不幸，我们可能需要测试所有的元素。平均来说，我们预计测试一半的元素，所以这种方法被认为是<strong>线性</strong>的（除了在不太可能的情况下，我们知道目标元素在数组的开头）<br></p>
</blockquote>
<h6 id="3-问题规模"><a href="#3-问题规模" class="headerlink" title="3.问题规模"></a>3.问题规模</h6><p><strong>RemoveAll</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeAll</span><span class="params">(Collection&lt;?&gt; collection)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (Object obj: collection) &#123;</span><br><span class="line">        flag &amp;= remove(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>每次循环中，<code>removeAll</code>都调用<code>remove</code>，这是线性的。所以认为<code>removeAll</code>是二次的很诱人。但事实并非如此。</p>
</blockquote>
<blockquote>
<p>在这种方法中，循环对于每个<code>collection</code>中的元素运行一次。如果<code>collection</code>包含<code>m</code>个元素，并且我们从包含<code>n</code>个元素的列表中删除，则此方法是<code>O(nm)</code>的。如果<code>collection</code>的大小可以认为是常数，<code>removeAll</code>相对于<code>n</code>是线性的。但是，如果集合的大小与<code>n</code>成正比，<code>removeAll</code>则是平方的。例如，如果<code>collection</code>总是包含<code>100</code>个或更少的元素， <code>removeAll</code>则是线性的。但是，如果<code>collection</code>通常包含的列表中的 1% 元素，<code>removeAll</code>则是平方的。</p>
</blockquote>
<blockquote>
<p><strong>当我们谈论问题规模时，我们必须小心我们正在讨论哪个大小</strong>。这个例子演示了算法分析的陷阱：对循环计数的诱人捷径。如果有一个循环，算法往往是 线性的。如果有两个循环（一个嵌套在另一个内），则该算法通常是平方的。不过要小心！<strong>你必须考虑每个循环运行多少次</strong>。如果所有循环的迭代次数与<code>n</code>成正比，你可以仅仅对循环进行计数之后离开。但是，如在这个例子中，<strong>迭代次数并不总是与<code>n</code>成正比</strong>，所以你必须考虑更多。</p>
</blockquote>
<br>

<p>原书链接：<a href="https://wizardforcel.gitbooks.io/think-dast/content/5.html" target="_blank" rel="noopener">https://wizardforcel.gitbooks.io/think-dast/content/5.html</a><br>GitHub链接(提供源码)：<a href="https://github.com/huoji555/Shadow/tree/master/DataStructure" target="_blank" rel="noopener">https://github.com/huoji555/Shadow/tree/master/DataStructure</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/04/10/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%20%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/">数据结构思维笔记（二） 算法分析</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-10</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4/">数据结构思维</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4/">数据结构思维</a></span><div class="content"><a id="more"></a>

<h6 id="1-简单算法分类"><a href="#1-简单算法分类" class="headerlink" title="1.简单算法分类"></a>1.简单算法分类</h6><ul>
<li>常数时间<strong>O(1)</strong>：不依赖于输入</li>
<li>线性<strong>O(n)</strong>:依赖于输入，并跟输入量大小成正比</li>
<li>平方<strong>O(n^2 )</strong>:随着n的增长变为n^2</li>
</ul>
<h6 id="2-简单排序"><a href="#2-简单排序" class="headerlink" title="2.简单排序"></a>2.简单排序</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">SelectionSort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Swaps the elements at indexes i and j.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="keyword">static</span> <span class="keyword">void</span> swapElements(int[] array, int i, int j) &#123;</span><br><span class="line">        int temp = array[i];</span><br><span class="line">        array[i] = array[j];</span><br><span class="line">        array[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Finds the index of the lowest value</span></span><br><span class="line"><span class="comment">     * starting from the index at start (inclusive)</span></span><br><span class="line"><span class="comment">     * and going to the end of the array.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="keyword">static</span> int indexLowest(int[] array, int start) &#123;</span><br><span class="line">        int lowIndex = start;</span><br><span class="line">        <span class="keyword">for</span> (int i = start; i &lt; array.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (array[i] &lt; array[lowIndex]) &#123;</span><br><span class="line">                lowIndex = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lowIndex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sorts the elements (in place) using selection sort.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="keyword">static</span> <span class="keyword">void</span> selectionSort(int[] array) &#123;</span><br><span class="line">        <span class="keyword">for</span> (int i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            int j = indexLowest(array, i);</span><br><span class="line">            swapElements(array, i, j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>swap()是常数级操作，时间恒定<br>indexLowest()复杂度，同n-start有关，属于线性关系<br>selectionSort()，需要算n(n-1)/2,属于平方关系<br><br><br></p>
<p>原书链接：<a href="https://wizardforcel.gitbooks.io/think-dast/content/1.html" target="_blank" rel="noopener">https://wizardforcel.gitbooks.io/think-dast/content/1.html</a><br>GitHub链接(提供源码)：<a href="https://github.com/huoji555/Shadow/tree/master/DataStructure" target="_blank" rel="noopener">https://github.com/huoji555/Shadow/tree/master/DataStructure</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/04/10/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%8E%A5%E5%8F%A3/">数据结构思维笔记（一）接口</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-10</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4/">数据结构思维</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%9D%E7%BB%B4-%E6%8E%A5%E5%8F%A3/">数据结构思维 接口</a></span><div class="content"><a id="more"></a>

<h6 id="1-为什么要有两种List"><a href="#1-为什么要有两种List" class="headerlink" title="1.为什么要有两种List"></a>1.为什么要有两种List</h6><blockquote>
<p>Java中List接口为ArrayList, LinkedList都继承于List.哪一个更适合于特定的应用程序，取决于它最常执行的操作.对于一些应用，<code>LinkedList</code>更快；对于其他应用，<code>ArrayList</code>更快.<br></p>
</blockquote>
<h6 id="2-List接口"><a href="#2-List接口" class="headerlink" title="2.List接口"></a>2.List接口</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListClientExample</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List list;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ListClientExample</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        list = <span class="keyword">new</span> LinkedList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List <span class="title">getList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> list;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ListClientExample lce = <span class="keyword">new</span> ListClientExample();</span><br><span class="line">        List list = lce.getList();</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <code>ListClientExample</code>没有任何有用的东西，但它封装了<code>List</code>，并具有一个类的基本要素。也就是说，它包含一个<code>List</code>实例变量。<br> <strong>通过实例化（也就是创建）新的<code>LinkedList</code>，这个<code>ListClientExample</code>构造函数初始化<code>list</code>；读取器方法叫做<code>getList</code>，返回内部<code>List</code>对象的引用；并且<code>main</code>包含几行代码来测试这些方法。</strong></p>
<p>这个例子的要点是，它尽可能地使用<code>List</code>，避免指定<code>LinkedList</code>，<code>ArrayList</code>，除非有必要。例如，实例变量被声明为<code>List</code>，并且<code>getList</code>返回<code>List</code>，但都不指定哪种类型的列表。<br>如果你改变主意并决定使用<code>ArrayList</code>，你只需要改变构造函数; 你不必进行任何其他更改。<br>这种风格被称为<strong>基于接口的编程</strong>，或者更随意，“面向接口编程”。这里我们谈论接口的一般思想，而不是 Java 接口。<br><br></p>
<p>原书链接：<a href="https://wizardforcel.gitbooks.io/think-dast/content/5.html" target="_blank" rel="noopener">https://wizardforcel.gitbooks.io/think-dast/content/5.html</a><br>GitHub链接(提供源码)：<a href="https://github.com/huoji555/Shadow/tree/master/DataStructure" target="_blank" rel="noopener">https://github.com/huoji555/Shadow/tree/master/DataStructure</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/04/09/Java%E5%AE%9E%E7%8E%B0%E8%AF%BE%E7%A8%8B%E6%8E%A8%E8%8D%90%E7%AE%97%E6%B3%95/">Java实现课程推荐算法</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-09</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/%E6%8E%A8%E8%8D%90%E7%AE%97%E6%B3%95/">推荐算法</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/%E6%8E%A8%E8%8D%90%E7%AE%97%E6%B3%95-Java%E6%8E%A8%E8%8D%90%E7%AE%97%E6%B3%95/">推荐算法 Java推荐算法</a></span><div class="content"><a id="more"></a>


<h4 id="1-需求分析"><a href="#1-需求分析" class="headerlink" title="1.需求分析"></a>1.需求分析</h4><p>现在有课程若干，需要在用户打开客户端时，推荐给用户相关内容。具体推荐规则如下:</p>
<blockquote>
<ul>
<li>有3个以上4分以上的：“基于您的个人能力测试，发现您的【xxx、xxx、xxx】很强”；<br>a)    Xxx: 为能力，随机选3个最高值。<br>比如：您的基于您的个人能力测试，发现您“语言能力、英语能力、逻辑能力”能力很强</li>
<li>¬    有4分以上的：“基于您的个人能力测试，发现您的【xxx、xxx、xxx】比较不错”；<br>a)    Xxx: 为能力，随机选3个最高值。</li>
<li>¬    没有4分以上的，3分及以下，提示能力最高的3个；同样分值，随机取几个，凑个3个能力：<br>a)    基于您的个人能力测试，发现您的【xxx、xxx 】能力比较均衡.；<br>比如：您的基于您的个人能力测试，发现您“语言能力、英语能力、逻辑能力”能力均衡</li>
</ul>
</blockquote>
<br>


<h4 id="2-实现思路"><a href="#2-实现思路" class="headerlink" title="2.实现思路"></a>2.实现思路</h4><p>设计思路其实很简单，我们需要把获取到的分数降序排序，如果相同就随机推荐相同分值的科目。</p>
<p>因为是K-V值关系的数据关系，所以可以选择用Map，用到排序，选用Map中的TreeMap，自己定义排序规则，需手写Compare方法。<br><br></p>
<h4 id="3-具体代码"><a href="#3-具体代码" class="headerlink" title="3.具体代码"></a>3.具体代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String result = <span class="string">""</span>;</span><br><span class="line">        Integer finalSize = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">double</span> math = <span class="number">4.2</span>;</span><br><span class="line">        <span class="keyword">double</span> chinese = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">double</span> english = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">double</span> computer = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">double</span> design = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">double</span> practice = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        map.put(<span class="string">"数学能力"</span>,math);</span><br><span class="line">        map.put(<span class="string">"语言能力"</span>,chinese);</span><br><span class="line">        map.put(<span class="string">"英文能力"</span>,english);</span><br><span class="line">        map.put(<span class="string">"逻辑能力"</span>,computer);</span><br><span class="line">        map.put(<span class="string">"设计能力"</span>,design);</span><br><span class="line">        map.put(<span class="string">"体育能力"</span>,practice);</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Double&gt; good = <span class="keyword">new</span> HashMap&lt;String, Double&gt;();</span><br><span class="line">        Map&lt;String,Double&gt; normal = <span class="keyword">new</span> HashMap&lt;String, Double&gt;();</span><br><span class="line">        Map&lt;String,Double&gt; bad = <span class="keyword">new</span> HashMap&lt;String, Double&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String,Object&gt; entry : map.entrySet()) &#123;</span><br><span class="line">            Double score =  (Double) entry.getValue();</span><br><span class="line">            String classes = entry.getKey();</span><br><span class="line">            <span class="keyword">if</span> (score &gt;= <span class="number">4</span>) &#123;</span><br><span class="line">                good.put(classes,score);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score&gt;=<span class="number">3</span> &amp;&amp; score&lt;<span class="number">4</span>) &#123;</span><br><span class="line">                normal.put(classes,score);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                bad.put(classes,score);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Double&gt; map1 = <span class="keyword">new</span> TreeMap&lt;String, Double&gt;(<span class="keyword">new</span> MapValueComparator&lt;Double&gt;(good));</span><br><span class="line">        Map&lt;String, Double&gt; map2 = <span class="keyword">new</span> TreeMap&lt;String, Double&gt;(<span class="keyword">new</span> MapValueComparator&lt;Double&gt;(normal));</span><br><span class="line">        Map&lt;String, Double&gt; map3 = <span class="keyword">new</span> TreeMap&lt;String, Double&gt;(<span class="keyword">new</span> MapValueComparator&lt;Double&gt;(bad));</span><br><span class="line">        map1.putAll(good);</span><br><span class="line">        map2.putAll(normal);</span><br><span class="line">        map3.putAll(bad);</span><br><span class="line"></span><br><span class="line">        String[] keys = map1.keySet().toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);</span><br><span class="line">        String[] keys1 = map2.keySet().toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);</span><br><span class="line">        String[] keys2 = map3.keySet().toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);</span><br><span class="line">        System.out.println(<span class="string">"测试前:"</span>+map.toString());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (good.size() &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"基于您的个人能力测试，发现您的【"</span>+Random(keys,result,finalSize)+<span class="string">"】能力很强"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (good.size()&gt;<span class="number">0</span> &amp;&amp; (normal.size()+good.size()&gt;=<span class="number">3</span> || bad.size()+good.size()&gt;=<span class="number">3</span>)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (String xx : keys) &#123;  result += (result == <span class="string">""</span> || result == <span class="keyword">null</span>) ? xx : <span class="string">","</span>+xx;&#125;</span><br><span class="line">            finalSize -= keys.length;</span><br><span class="line">            <span class="keyword">if</span> (normal.size()+good.size() &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">                System.out.println(<span class="string">"基于您的个人能力测试，发现您的【"</span>+Random(keys1,result,finalSize)+<span class="string">"】比较不错"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (bad.size()+good.size() &gt;= <span class="number">3</span> &amp;&amp;  normal.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(<span class="string">"基于您的个人能力测试，发现您的【"</span>+Random(keys2,result,finalSize)+<span class="string">"】比较不错"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (String xx : keys1) &#123;  result += (result == <span class="string">""</span> || result == <span class="keyword">null</span>) ? xx : <span class="string">","</span>+xx;&#125;</span><br><span class="line">                finalSize -= keys1.length;</span><br><span class="line">                System.out.println(<span class="string">"基于您的个人能力测试，发现您的【"</span>+Random(keys2,result,finalSize)+<span class="string">"】比较不错"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (keys1.length &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">                System.out.println(<span class="string">"基于您的个人能力测试，发现您的【"</span>+Random(keys1,result,finalSize)+<span class="string">"】比较均衡"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (String xx : keys1) &#123;  result += (result == <span class="string">""</span> || result == <span class="keyword">null</span>) ? xx : <span class="string">","</span>+xx;&#125;</span><br><span class="line">                finalSize -= keys1.length;</span><br><span class="line">                System.out.println(<span class="string">"基于您的个人能力测试，发现您的【"</span>+Random(keys2,result,finalSize)+<span class="string">"】比较均衡"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span> Ragty</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>  随机科目</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span> 11:07 2019/4/8</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">Random</span><span class="params">(String[] keys,String result,Integer finalSize)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;finalSize; i++) &#123;</span><br><span class="line">            result += (result == <span class="string">""</span> || result == <span class="keyword">null</span>) ? keys[i] : <span class="string">","</span>+keys[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span> Ragty</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>  比较器（按值排序,相同的随机取值）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span> 10:38 2019/4/9</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MapValueComparator</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">T</span>&gt;&gt; <span class="keyword">implements</span> <span class="title">Comparator</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String, T&gt; map = <span class="keyword">null</span>;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MapValueComparator</span><span class="params">(Map&lt;String, T&gt; map)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.map = map;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(String o1, String o2)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> r = map.get(o2).compareTo(map.get(o1));</span><br><span class="line">            <span class="keyword">if</span> (r != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> r;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> randomOne = (<span class="keyword">int</span>) (Math.random() * <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">int</span> randomTwo = (<span class="keyword">int</span>) (Math.random() * <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">return</span> randomOne - randomTwo;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>


<h4 id="4-测试结果-多组结果"><a href="#4-测试结果-多组结果" class="headerlink" title="4.测试结果(多组结果)"></a>4.测试结果(多组结果)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">测试前:&#123;语言能力=<span class="number">4.2</span>, 设计能力=<span class="number">3.0</span>, 英文能力=<span class="number">2.0</span>, 数学能力=<span class="number">3.0</span>, 逻辑能力=<span class="number">3.0</span>, 体育能力=<span class="number">1.0</span>&#125;</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">基于您的个人能力测试，发现您的【语言能力,数学能力,设计能力】比较不错</span><br><span class="line"></span><br><span class="line">测试前:&#123;语言能力=<span class="number">4.2</span>, 设计能力=<span class="number">3.0</span>, 英文能力=<span class="number">2.0</span>, 数学能力=<span class="number">3.0</span>, 逻辑能力=<span class="number">3.0</span>, 体育能力=<span class="number">1.0</span>&#125;</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">基于您的个人能力测试，发现您的【语言能力,逻辑能力,设计能力】比较不错</span><br><span class="line"></span><br><span class="line">测试前:&#123;语言能力=<span class="number">4.2</span>, 设计能力=<span class="number">3.0</span>, 英文能力=<span class="number">2.0</span>, 数学能力=<span class="number">3.0</span>, 逻辑能力=<span class="number">3.0</span>, 体育能力=<span class="number">1.0</span>&#125;</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line">基于您的个人能力测试，发现您的【语言能力,数学能力,逻辑能力】比较不错</span><br></pre></td></tr></table></figure>


</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/03/28/MySql%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/">MySql存储过程</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-03-28</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B-Mysql%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/">存储过程 Mysql存储过程</a></span><div class="content"><a id="more"></a>

<h1 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h1><h4 id="1-存储过程概念"><a href="#1-存储过程概念" class="headerlink" title="1.存储过程概念"></a>1.存储过程概念</h4><p>存储过程是<strong>一组为了完成特定功能的SQL语句集</strong>，经编译后存储在数据库中。用户通过指定存储过程的名字并给出参数(如果该存储过程带有参数)来执行它。存储过程可由应用程序通过一个调用来执行，而且允许用户声明变量 。同时，存储过程可以接收和输出参数、返回执行存储过程的状态值，也可以嵌套调用。(<strong>相当于一个函数</strong>)<br></p>
<h4 id="2-存储过程与函数的区别"><a href="#2-存储过程与函数的区别" class="headerlink" title="2.存储过程与函数的区别"></a>2.存储过程与函数的区别</h4><p>函数往往作为<strong>公式</strong>使用，存储过程作为<strong>完成某种功能使用</strong>。</p>
<p>函数分为<strong>表值函数(通过sql返回一张表)</strong>跟<strong>标量函数(通过sql返回一个值)</strong>。</p>
<p>函数可以在select语句中直接使用，而过程不能。<br></p>
<h4 id="3-存储过程优点"><a href="#3-存储过程优点" class="headerlink" title="3.存储过程优点"></a>3.存储过程优点</h4><ul>
<li><strong>减少网络通信量</strong>。调用一个行数不多的存储过程与直接调用SQL语句的网络通信量可能不会有很大的差别，可是如果存储过程包含上百行SQL语句，那么其性能绝对比一条一条的调用SQL语句要高得多。</li>
<li><strong>执行速度更快</strong>。存储过程创建的时候，数据库已经对其进行了一次解析和优化。其次，存储过程一旦执行，在内存中就会保留一份这个存储过程，这样下次再执行同样的存储过程时，可以从内存中直接中读取。</li>
<li><strong>更强的安全性</strong>。存储过程是通过向用户授予权限(而不是基于表)，它们可以提供对特定数据的访问，提高代码安全，比如防止 SQL注入。</li>
<li><strong>业务逻辑可以封装存储过程中</strong>，这样不仅容易维护，而且执行效率也高<br></li>
</ul>
<h4 id="4-存储过程缺点"><a href="#4-存储过程缺点" class="headerlink" title="4.存储过程缺点"></a>4.存储过程缺点</h4><ul>
<li><strong>可移植性方面</strong>：当从一种数据库迁移到另外一种数据库时，不少的存储过程的编写要进行部分修改</li>
<li><strong>存储过程需要花费一定的学习时间去学习</strong>，比如学习其语法等</li>
</ul>
<h4 id="5-存储过程的编写"><a href="#5-存储过程的编写" class="headerlink" title="5.存储过程的编写"></a>5.存储过程的编写</h4><h6 id="定义存储过程的结束符"><a href="#定义存储过程的结束符" class="headerlink" title="定义存储过程的结束符"></a>定义存储过程的结束符</h6><blockquote>
<p>sql中我们用;隔开结尾，存储过程中我们用 <strong>DELIMITER //</strong>定义分隔符，//为自定义的分隔符<br></p>
</blockquote>
<h6 id="如何创建存储过程"><a href="#如何创建存储过程" class="headerlink" title="如何创建存储过程"></a>如何创建存储过程</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER &#x2F;&#x2F;</span><br><span class="line">CREATEPROCEDURE &#96;p2&#96; ()</span><br><span class="line">LANGUAGE SQL</span><br><span class="line">DETERMINISTIC</span><br><span class="line">SQL SECURITY DEFINER</span><br><span class="line">COMMENT &#39;A procedure&#39;</span><br><span class="line">BEGIN</span><br><span class="line">SELECT&#39;Hello World !&#39;;</span><br><span class="line">END&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<p><strong>CREATE PROCEDURE</strong>+<strong>存储过程名的方法</strong>创建存储过程</p>
<p><strong>LANGUAGE</strong>选项指定了使用的语言，这里默认是使用SQL。</p>
<p><strong>DETERMINISTIC</strong>，声明它是否为确定型函数（输入一的结果肯定为2），默认为不确定型。</p>
<p><strong>SQL SECURITY</strong>，是表示调用时检查用户的权限。当值为INVOKER时，表示是用户调用该存储过程时检查，默认为DEFINER,即创建存储过程时检查。</p>
<p><strong>COMMENT</strong>部分是存储过程的注释说明部分。</p>
<p><strong>BEGIN    END</strong>部分中，是存储过程的主体部分。<br></p>
<h6 id="调用存储过程的方法"><a href="#调用存储过程的方法" class="headerlink" title="调用存储过程的方法"></a>调用存储过程的方法</h6><p>使用call命令，后边跟调用存储过程的名称及输入的变量列表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CALL stored_procedure_name (param1, param2, ....)</span><br><span class="line">CALL procedure1(10 , &#39;string parameter&#39; , @parameter_var);</span><br></pre></td></tr></table></figure>

<br>



<h6 id="修改和删除存储过程"><a href="#修改和删除存储过程" class="headerlink" title="修改和删除存储过程"></a>修改和删除存储过程</h6><p><strong>修改：</strong>ALTER的语法去修改存储过程的主要特征和参数，</p>
<p>​       要修改其存储过程的主体部分的话，必须要先删除然后再重建</p>
<p>e.g：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER PROCEDURE num_from		&#x2F;&#x2F;修改存储过程的定义，将读写权限改为 MODIFIES SQL DATA</span><br><span class="line">MODIFIES SQL DATA SQL SECURITY INVOKER ;   &#x2F;&#x2F;并指明调用者可执行</span><br></pre></td></tr></table></figure>

<p><strong>删除：</strong>使用DROP关键词</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE IF EXISTS p2;</span><br></pre></td></tr></table></figure>



<h6 id="存储过程的参数"><a href="#存储过程的参数" class="headerlink" title="存储过程的参数"></a>存储过程的参数</h6><ul>
<li><p>CREATE PROCEDURE proc1 () 这个存储过程中是空的参数列表</p>
</li>
<li><p>CREATE PROCEDURE proc1 (<strong>IN varname DATA-TYPE</strong>) 这个存储过程中有一个输出参数，名称为varname，后面是跟数据类型DATA-TYPE,<strong>IN参数是默认的</strong>，因此可以省略不写</p>
</li>
<li><p>CREATE PROCEDURE proc1 (<strong>OUT varname DATA-TYPE</strong>) 这个存储过程中varname为输出参数</p>
</li>
<li><p>CREATE PROCEDURE proc1 (<strong>INOUT varname DATA-TYPE</strong>) 这个存储过程中，varname既是输入参数也是输出参数</p>
</li>
</ul>
<p><strong>IN输入参数的例子</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER &#x2F;&#x2F;</span><br><span class="line">CREATE PROCEDURE &#96;proc_IN&#96; (IN var1 INT)</span><br><span class="line">BEGIN</span><br><span class="line">    SELECT var1 + 2 AS result;</span><br><span class="line">END&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<p><strong>OUT输入参数的例子</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DeLIMITER &#x2F;&#x2F;</span><br><span class="line">CREATE PROCEDURE &#96;proc_OUT&#96;(OUT var1 varchar(100))</span><br><span class="line">BEGIN</span><br><span class="line">    SET var1 &#x3D; &#39;This is the test!&#39;;</span><br><span class="line">END&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<p><strong>IN-OUT的例子</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER &#x2F;&#x2F;</span><br><span class="line">CREATE PROCEDURE &#96;proc_IN_OUT&#96;(OUT var1 INT)</span><br><span class="line">BEGIN</span><br><span class="line">   SET var1 &#x3D; var1+2;</span><br><span class="line">END&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<br>



<h6 id="存储过程定义变量"><a href="#存储过程定义变量" class="headerlink" title="存储过程定义变量"></a>存储过程定义变量</h6><blockquote>
<p>必须显式地在存储过程的一开始声明变量，并指出它们的数据类型，一但声明了变量后，就可以在存储过程中使用</p>
</blockquote>
<p><code>DECLARE varname DATA-TYPE DEFAULT defaultvalue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DECLARE a, b INT DEFAULT 5;</span><br><span class="line">DECLARE str VARCHAR(50);</span><br><span class="line">DECLARE today TIMESTAMP DEFAULT CURRENT_DATE;</span><br><span class="line">DECLARE v1, v2, v3 TINYINT;</span><br></pre></td></tr></table></figure>

<p>调用过程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER &#x2F;&#x2F;</span><br><span class="line">CREATE PROCEDURE &#96;var_proc&#96; (IN paramstr VARCHAR(20))</span><br><span class="line">BEGIN</span><br><span class="line">　　DECLARE a, b INT DEFAULT 5;</span><br><span class="line">　　DECLARE str VARCHAR(50);</span><br><span class="line">　　DECLARE today TIMESTAMP DEFAULT CURRENT_DATE;</span><br><span class="line">　　DECLARE v1, v2, v3 TINYINT;</span><br><span class="line">　　INSERT INTO table1 VALUES (a);</span><br><span class="line">　　SET str &#x3D; &#39;I am a string&#39;;</span><br><span class="line">　　SELECT CONCAT(str,paramstr), today FROM table2 WHERE b&gt;&#x3D;5;</span><br><span class="line">END &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<br>



<h4 id="6-存储过程的语法结构"><a href="#6-存储过程的语法结构" class="headerlink" title="6.存储过程的语法结构"></a><strong>6.存储过程的语法结构</strong></h4><blockquote>
<p>MYSQL存储过程中支持IF，CASE，ITERATE，LEAVE LOOP，WHILE和REPEAT等语法结构和语句<br></p>
</blockquote>
<p><strong>IF语句</strong>（if语句使用的是if…then end if的语法结构）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER &#x2F;&#x2F;</span><br><span class="line">CREATE PROCEDURE &#96;proc_IF&#96; (IN param1 INT)</span><br><span class="line">BEGIN</span><br><span class="line">　　DECLARE variable1 INT;</span><br><span class="line">　　SET variable1 &#x3D; param1 + 1;</span><br><span class="line">　　IF variable1 &#x3D; 0 THEN</span><br><span class="line">　　    SELECT variable1;</span><br><span class="line">　　END IF;</span><br><span class="line">　　IF param1 &#x3D; 0 THEN</span><br><span class="line">　　    SELECT &#39;Parameter value &#x3D; 0&#39;;</span><br><span class="line">　　ELSE</span><br><span class="line">　　    SELECT &#39;Parameter value &lt;&#x3D; 0&#39;;</span><br><span class="line">　　END IF;</span><br><span class="line">END &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<br>



<p><strong>CASE语句</strong>（当有很多IF语句时，就应该考虑使用CASE语句了，它是多分支选择语句）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER &#x2F;&#x2F;</span><br><span class="line">CREATE PROCEDURE &#96;proc_CASE&#96; (IN param1 INT)</span><br><span class="line">BEGIN</span><br><span class="line">　　DECLARE variable1 INT;</span><br><span class="line">　　SET variable1 &#x3D; param1 + 1;</span><br><span class="line">　　CASE variable1</span><br><span class="line">　　WHEN 0 THEN</span><br><span class="line">　　    INSERT INTO table1 VALUES (param1);</span><br><span class="line">　　WHEN 1 THEN</span><br><span class="line">　　    INSERT INTO table1 VALUES (variable1);</span><br><span class="line">　　ELSE</span><br><span class="line">　　    INSERT INTO table1 VALUES (99);</span><br><span class="line">　　END CASE;</span><br><span class="line">END &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<br>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER &#x2F;&#x2F;</span><br><span class="line">CREATE PROCEDURE &#96;proc_CASE&#96; (IN param1 INT)</span><br><span class="line">BEGIN</span><br><span class="line">　　DECLARE variable1 INT;</span><br><span class="line">　　SET variable1 &#x3D; param1 + 1;</span><br><span class="line">　　CASE</span><br><span class="line">　　WHEN variable1 &#x3D; 0 THEN</span><br><span class="line">　　    INSERT INTO table1 VALUES (param1);</span><br><span class="line">　　WHEN variable1 &#x3D; 1 THEN</span><br><span class="line">　　    INSERT INTO table1 VALUES (variable1);</span><br><span class="line">　　ELSE</span><br><span class="line">　　    INSERT INTO table1 VALUES (99);</span><br><span class="line">　　END CASE;</span><br><span class="line">END &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<br>



<p><strong>WHILE语句</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER &#x2F;&#x2F;</span><br><span class="line">CREATE PROCEDURE &#96;proc_WHILE&#96; (IN param1 INT)</span><br><span class="line">BEGIN</span><br><span class="line">　　DECLARE variable1, variable2 INT;</span><br><span class="line">　　SET variable1 &#x3D; 0;</span><br><span class="line">　　WHILE variable1</span><br><span class="line">　　    INSERT INTO table1 VALUES (param1);</span><br><span class="line">　　    SELECT COUNT(*) INTO variable2 FROM table1;</span><br><span class="line">　　    SET variable1 &#x3D; variable1 + 1;</span><br><span class="line">　　END WHILE;</span><br><span class="line">END &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<br>



<h4 id="7-Mysql存储过程中的游标"><a href="#7-Mysql存储过程中的游标" class="headerlink" title="7.Mysql存储过程中的游标"></a>7.Mysql存储过程中的游标</h4><blockquote>
<p>MySQL中的游标是一个十分重要的概念。游标提供了一种对从表中检索出的数据进行操作的灵活手段，就本质而言，游标实际上是一种<strong>能从包括多条数据记录的结果集中每次提取一条记录的机制</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DECLARE cursor-name CURSOR FOR SELECT ...; &#x2F;* 声明一个游标，名称为cursor-name,并用CURSOR                                              FOR SELECT*&#x2F;</span><br><span class="line">DECLARE CONTINUE HANDLER FOR NOT FOUND &#x2F;*指定当遍历完结果集后，游标如何继续处理*&#x2F;</span><br><span class="line">OPEN cursor-name; &#x2F;*打开游标 *&#x2F;</span><br><span class="line">FETCH cursor-name INTO variable [, variable]; &#x2F;* 将变量赋值给游标*&#x2F;</span><br><span class="line">CLOSE cursor-name; &#x2F;*使用后关闭游标*&#x2F;</span><br></pre></td></tr></table></figure>

<p>e.g</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER &#x2F;&#x2F;</span><br><span class="line">CREATE PROCEDURE &#96;proc_CURSOR&#96; (OUT param1 INT)</span><br><span class="line">BEGIN</span><br><span class="line">　　DECLARE a, b, c INT;</span><br><span class="line">　　DECLARE cur1 CURSOR FOR SELECT col1 FROM table1;</span><br><span class="line">　　DECLARE CONTINUE HANDLER FOR NOT FOUND SET b &#x3D; 1;</span><br><span class="line">　　OPEN cur1;</span><br><span class="line">　　SET b &#x3D; 0;</span><br><span class="line">　　SET c &#x3D; 0;</span><br><span class="line">　　WHILE b &#x3D; 0 DO</span><br><span class="line">　　    FETCH cur1 INTO a;</span><br><span class="line">　　    IF b &#x3D; 0 THEN</span><br><span class="line">　　        SET c &#x3D; c + a;</span><br><span class="line">　　    END IF;</span><br><span class="line">　　END WHILE;</span><br><span class="line">　　CLOSE cur1;</span><br><span class="line">　　SET param1 &#x3D; c;</span><br><span class="line">END &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>其中，DECLARE cur1 CURSOR FOR SELECT col1 FROM table1;</p>
<p>表示将从table1表中选取col1列的内容放到游标curl中，即每次游标遍历的结果都放在curl中，要注意游标只能向前遍历，而不能向后，并且注意，游标不能更新，最后关闭游标。</p>
</blockquote>
<p>附上人生第一个SQL存储过程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">CREATE DEFINER &#x3D; &#96;root&#96;@&#96;localhost&#96; PROCEDURE &#96;NewProc&#96;(INOUT &#96;left1&#96; varchar(20),INOUT &#96;right1&#96; varchar(20),INOUT &#96;feed1&#96; varchar(20))</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE leftlen,rightlen,feedlen INT;</span><br><span class="line">	SET leftlen &#x3D; len(leftl);</span><br><span class="line">	SET rightlen &#x3D; len(rightl);</span><br><span class="line">	SET feedlen &#x3D; len(feedl);</span><br><span class="line">	</span><br><span class="line">	IF not EXISTS (select autocode from autocode where autocode like CONCAT(left1,&#39;%&#39;) and autocode like CONCAT(&#39;%&#39;,right1)) THEN</span><br><span class="line">		insert into autocode (autocode) values ( CONCAT(left1,feed1,right1));</span><br><span class="line">		select CONCAT(left1,feed1,right1) as autocode;</span><br><span class="line">  ELSE </span><br><span class="line">		insert into autocode </span><br><span class="line">		select CONCAT(left1,max(substring(autocode,leftlen+1,feedlen))+1,right1) from autocode where autocode like CONCAT(left1,&#39;%&#39;) and autocode like CONCAT(&#39;%&#39;,right1);</span><br><span class="line">		delete from autocode where autocode like CONCAT(left1,&#39;%&#39;) and autocode like CONCAT(&#39;%&#39;,right1)</span><br><span class="line">		and autocode not in (select max(autocode) from autocode where autocode like CONCAT(left1,&#39;%&#39;) and autocode like CONCAT(&#39;%&#39;,right1));</span><br><span class="line">		select max(autocode)  as autocode  from  autocode where autocode like CONCAT(left1,&#39;%&#39;) and autocode like CONCAT(&#39;%&#39;,right1);</span><br><span class="line">set feedlen &#x3D; 2323;</span><br><span class="line">	END IF;</span><br><span class="line">   </span><br><span class="line">END;</span><br></pre></td></tr></table></figure>


</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/03/19/Java%E5%AE%9E%E7%8E%B0%E5%AE%9A%E6%97%B6%E4%BB%8E%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6(Redis%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97)/">Java实现定时从远程服务器下载文件(Redis消息队列)</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-03-19</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/Redis/">Redis</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/Redis%E9%98%9F%E5%88%97-%E8%BF%9C%E7%A8%8B%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6-https/">Redis队列 远程下载文件(https)</a></span><div class="content"><a id="more"></a>

<h3 id="1-需求"><a href="#1-需求" class="headerlink" title="1.需求"></a>1.需求</h3><ul>
<li>获取Redis队列中的文件名称</li>
<li>更新远程服务器上的资源到本地(Https)</li>
<li>定时刷新，一但那边的服务器上传文件，就下载<br><br></li>
</ul>
<h3 id="2-从Redis中获取文件名称-此时的Redis相当于一个消息队列"><a href="#2-从Redis中获取文件名称-此时的Redis相当于一个消息队列" class="headerlink" title="2.从Redis中获取文件名称(此时的Redis相当于一个消息队列)"></a>2.从Redis中获取文件名称(此时的Redis相当于一个消息队列)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span> Ragty</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span> 定时程序(每十秒请求一次)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span> 15:05 2019/3/19</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    <span class="meta">@Scheduled</span>(fixedDelay = <span class="number">10</span>*<span class="number">1000</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ListOperations los = redisTemplate.opsForList();</span><br><span class="line">        List&lt;String&gt; list = los.range(reidsPath,<span class="number">0</span>,-<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (list.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (String fileUrl : list) &#123;</span><br><span class="line">                System.out.println(<span class="string">"Download File ..."</span>);</span><br><span class="line">                fileUrl = los.leftPop(reidsPath).toString().replaceAll(<span class="string">" "</span>,<span class="string">""</span>);</span><br><span class="line">                down(fileUrl);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"Waiting ..."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<br>



<h3 id="3-从远程地址下载文件资源-Htpps"><a href="#3-从远程地址下载文件资源-Htpps" class="headerlink" title="3.从远程地址下载文件资源(Htpps)"></a>3.从远程地址下载文件资源(Htpps)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span> Ragty</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span> 下载文件(https)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span> 17:25 2019/3/19</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">down</span><span class="params">(String fileUrl)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        String fileLocal = fileUrl.split(spiltPath)[<span class="number">1</span>];</span><br><span class="line">        String[] array = fileLocal.split(<span class="string">"/"</span>);</span><br><span class="line">        String folder = rootPath + fileLocal.split(array[array.length-<span class="number">1</span>])[<span class="number">0</span>].trim();</span><br><span class="line"></span><br><span class="line">        File file = <span class="keyword">new</span> File(folder);</span><br><span class="line">        <span class="keyword">if</span> (!file.exists())&#123;</span><br><span class="line">            file.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        X509TrustManager x509m = <span class="keyword">new</span> X509TrustManager() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkClientTrusted</span><span class="params">(X509Certificate[] x509Certificates, String s)</span> <span class="keyword">throws</span> CertificateException </span>&#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkServerTrusted</span><span class="params">(X509Certificate[] x509Certificates, String s)</span> <span class="keyword">throws</span> CertificateException </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> X509Certificate[<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        SSLContext sslcontext = SSLContext.getInstance(<span class="string">"SSL"</span>, <span class="string">"SunJSSE"</span>);</span><br><span class="line">        sslcontext.init(<span class="keyword">null</span>, <span class="keyword">new</span> TrustManager[] &#123;x509m&#125;, <span class="keyword">new</span> java.security.SecureRandom());</span><br><span class="line">        URL url = <span class="keyword">new</span> URL(fileUrl);</span><br><span class="line">        HostnameVerifier ignoreHostnameVerifier = <span class="keyword">new</span> HostnameVerifier() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">verify</span><span class="params">(String s, SSLSession sslsession)</span> </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">"WARNING: Hostname is not matched for cert."</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        HttpsURLConnection.setDefaultHostnameVerifier(ignoreHostnameVerifier);</span><br><span class="line">        HttpsURLConnection.setDefaultSSLSocketFactory(sslcontext.getSocketFactory());</span><br><span class="line">        HttpsURLConnection urlCon = (HttpsURLConnection) url.openConnection();</span><br><span class="line">        urlCon.setConnectTimeout(<span class="number">6000</span>);</span><br><span class="line">        urlCon.setReadTimeout(<span class="number">6000</span>);</span><br><span class="line">        <span class="keyword">int</span> code = urlCon.getResponseCode();</span><br><span class="line">        <span class="keyword">if</span> (code != HttpURLConnection.HTTP_OK) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"文件读取失败"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 读文件流</span></span><br><span class="line">        DataInputStream in = <span class="keyword">new</span> DataInputStream(urlCon.getInputStream());</span><br><span class="line">        DataOutputStream out = <span class="keyword">new</span> DataOutputStream(<span class="keyword">new</span> FileOutputStream(fileLocal));</span><br><span class="line">        <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((count = in.read(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            out.write(buffer, <span class="number">0</span>, count);</span><br><span class="line">        &#125;</span><br><span class="line">        out.close();</span><br><span class="line">        in.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<br>



<h3 id="4-注意事项"><a href="#4-注意事项" class="headerlink" title="4.注意事项"></a>4.注意事项</h3><p><strong>本文中的定时程序需要在启动类里开启定时调度</strong>（否则无法定时执行）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableScheduling</span></span><br></pre></td></tr></table></figure>

<p><strong>本文中的变量从配置文件里获取</strong>(下面给出文中定义的变量)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line">   <span class="meta">@Value</span>(<span class="string">"$&#123;redis.path&#125;"</span>)</span><br><span class="line">   <span class="keyword">private</span> String reidsPath;</span><br><span class="line">   <span class="meta">@Value</span>(<span class="string">"$&#123;download.file.spiltPath&#125;"</span>)</span><br><span class="line">   <span class="keyword">private</span> String spiltPath;</span><br><span class="line">   <span class="meta">@Value</span>(<span class="string">"$&#123;download.file.rootPath&#125;"</span>)</span><br><span class="line">   <span class="keyword">private</span> String rootPath;</span><br></pre></td></tr></table></figure>


</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/blog/2019/03/15/%E8%A7%A3%E5%86%B3SpringBoot%E4%B8%ADRedisTemplate%E5%AD%98%E5%82%A8%E6%97%B6%E5%87%BA%E7%8E%B0%E7%9A%84%E4%B9%B1%E7%A0%81/">解决SpringBoot中RedisTemplate存储时出现的乱码</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-03-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/blog/categories/Redis/">Redis</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/blog/tags/Redis%E4%B9%B1%E7%A0%81-redis/">Redis乱码 redis</a></span><div class="content"><a id="more"></a>

<h3 id="1-问题描述"><a href="#1-问题描述" class="headerlink" title="1.问题描述"></a>1.问题描述</h3><blockquote>
<p>往Redis里存数据时，会出现一系列的乱码<br>\xAC\xED\x00\x05t\x00\x04uuid</p>
</blockquote>
<br>

<h3 id="2-乱码原因"><a href="#2-乱码原因" class="headerlink" title="2.乱码原因"></a>2.乱码原因</h3><blockquote>
<p>spring-data-redis的RedisTemplate&lt;K, V&gt;模板类在操作redis时默认使用JdkSerializationRedisSerializer来进行序列化</p>
</blockquote>
<h3 id="3-解决方案"><a href="#3-解决方案" class="headerlink" title="3.解决方案"></a>3.解决方案</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RedisSerializer stringSerializer &#x3D; new StringRedisSerializer();</span><br><span class="line"></span><br><span class="line">redisTemplate.setKeySerializer(stringSerializer);</span><br><span class="line">redisTemplate.setValueSerializer(stringSerializer);</span><br><span class="line">redisTemplate.setHashKeySerializer(stringSerializer);</span><br><span class="line">redisTemplate.setHashValueSerializer(stringSerializer);</span><br></pre></td></tr></table></figure>

</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/blog/page/3/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/blog/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/9/">9</a><a class="extend next" rel="next" href="/blog/page/5/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://blog-1251750343.cos.ap-beijing.myqcloud.com/blog/blog-bg.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2020 By Ragty</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="footer_custom_text"><a href="http://beian.miit.gov.cn " target="_blank" rel="noopener" charset="utf-8"> ICP备案号:京ICP备<13502>号 </a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/blog/js/utils.js?version=1.7.0"></script><script src="/blog/js/fancybox.js?version=1.7.0"></script><script src="/blog/js/sidebar.js?version=1.7.0"></script><script src="/blog/js/copy.js?version=1.7.0"></script><script src="/blog/js/fireworks.js?version=1.7.0"></script><script src="/blog/js/transition.js?version=1.7.0"></script><script src="/blog/js/scroll.js?version=1.7.0"></script><script src="/blog/js/head.js?version=1.7.0"></script><script src="/blog/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>